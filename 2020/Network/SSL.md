# SSL (Secure Socket Layer)

SSL은 암호화된 데이터를 전송하기 위해서 공개키와 대칭키를 혼합해서 사용한다. 클라이언트와 서버가 주고 받는 정보는 대칭키 방식으로 암호화, 대칭키는 공개키 방식으로 암호화 해서 클라이언트와 서버가 주고 받는다.

1. 클라이언트가 서버에 접속 (Client Hello)
    - 클라이언트 측에서 생성한 랜덤 데이터
    - 클라이언트가 지원하는 암호화 방식들
    - 세션 아이디 (이미 SSL 핸드쉐이킹을 했으면 기존 세션 재활용)
2. Server Hello
    - 서버 측에서 생성한 랜덤 데이터
    - 서버가 선택한 클라이언트의 암호화 방식
    - 인증서
3. 클라이언트는 서버의 인증서가 CA(Certificate Authority)에 의해 발급된 것인지 확인함(CA 리스트를 확인) CA 리스트에 인증서가 없으면 경고 메시지 출력, 인증서가 CA에 의해 발급된 것인지 확인하기 위해 클라이언트에 내장된 CA의 공개키를 이용해서 인증서를 복호화함. 복호화에 성공했으면 인증서는 해당 CA의 개인키로 암호화 된 문서이므로, 인증서를 신뢰할 수 있게 된다.
    - 클라이언트는 서버의 랜덤 데이터와 클라이언트가 생성한 랜덤 데이터를 조합해서 pre master secret 이라는 키를 생성한다.
    - 이 pre master secret은 서버의 공개키로 암호화해서 서버로 전송하면 서버는 자신의 비밀키로 복호화 한다.(이러면 서버와 클라이언트 모두 pre master secret key를 공유하게 됨)
    - 이 pre master secret을 일련의 과정을 거쳐 master secret으로 만듦
    - master secret을 가지고 session key를 생성하는데 이 session key를 이용해서 데이터를 주고 받을 때 대칭키 방식으로 암호화한다.
4. 핸드쉐이크 종료
5. 세션
    - 서버와 클라이언트가 데이터를 주고 받는 단계
    - 위에서 생성한 session key 값을 이용해서 대칭키 방식으로 암호화 함
6. 데이터의 전송이 끝나면 SSL 통신이 끝났음을 서로에게 알려준다. 사용했던 session key는 폐기한다.

**인증 기관은 다음과 같이 이용된다.**

1. 서버의 운영자가 인증 기관에 공개키를 제출
2. 인증 기관은 제출된 공개키에 디지털 서명을 하고 서명이 끝난 공개키를 만든다.
3. 공개키 인증서에 서명이 끝난 공개키를 담는다.
4. 서버는 이 공개키 인증서를 클라이언트에 보내고 공개키 암호로 통신을 한다.
5. 공개키 인증서를 받은 클라이언트는 증명 기관의 공개키를 사용해서 서버의 공개키를 인증한 것이 CA라는 것과 서버의 공개키가 신뢰할 수 있다는 것을 알 수 있다.

## 참고자료

- [생활코딩 - SSL통신과정](https://www.youtube.com/watch?v=8R0FUF_t_zk&ab_channel=%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9)

킹활코딩..
