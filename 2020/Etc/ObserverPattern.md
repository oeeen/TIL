# 옵저버 패턴

> 옵서버 패턴(observer pattern)은 객체의 상태 변화를 관찰하는 관찰자들, 즉 옵저버들의 목록을 객체에 등록하여 상태 변화가 있을 때마다 메서드 등을 통해 객체가 직접 목록의 각 옵저버에게 통지하도록 하는 디자인 패턴이다. 주로 분산 이벤트 핸들링 시스템을 구현하는 데 사용된다. 발행/구독 모델로 알려져 있기도 하다. [위키백과](https://ko.wikipedia.org/wiki/%EC%98%B5%EC%84%9C%EB%B2%84_%ED%8C%A8%ED%84%B4)

## 신문을 구독하는 방법

1. 신문사가 신문을 찍어낸다.
2. 독자가 구독신청을 하면 매번 새로운 신문/잡지가 나올 때마다 배달을 받는다. 계속 구독자로 남아있으면 계속해서 신문/잡지를 받을 수 있다.
3. 신문/잡지를 더 이상 보고 싶지 않으면 구독 해지 신청을 한다.
4. 신문사가 영업을 한다면, 꾸준히 구독 및 해지를 하게된다.

## 출판사 + 구독자 = 옵저버 패턴

위에서 출판사 + 구독자 가 옵저버 패턴의 핵심이다. 출판사는 subject, 구독자는 observer라고 부른다.

1. Subject 객체에서 일부 데이터를 관리한다.
2. Subject의 데이터가 달라지면 옵저버한테 소식이 전달된다.
3. Observer 객체들은 subject를 구독하고 있고, subject의 데이터가 변경되면 갱신된 내용을 전달 받는다.

위에서 예시로 들었던 신문사를 구독하는 것처럼 여기서도 새로운 어떤 객체가 Subject 객체에 구독을 요청할 수 있다. Subject객체에 구독을 요청하고 새로운 객체가 Observer로 등록되면 그 객체에도 이제 subject의 데이터가 변경될 때 갱신된 내용을 전달받게 된다.

> 옵저버 패턴에서는 한 객체의 상태가 바뀌면 그 객체에 의존하는 다른 객체들한테 연락이 가고 자동으로 내용이 갱신되는 방식으로 일대다(One To Many) 의존성을 정의한다.

옵저버 패턴을 구현하는 방법에는 여러가지가 있지만, 대부분 Subject Interface와 Observer Interface가 들어있는 클래스 디자인을 바탕으로 한다.

## 느슨한 결합

두 객체가 느슨하게 결합되어 있다는 것은, 둘이 상호작용을 하긴 하지만 서러에 대해 잘 모른다는 것이다.

옵저버 패턴에서는 Subject와 Observer가 느슨하게 결합되어 있는 객체 디자인을 제공한다.

1. Subject가 Observer에 대해 아는 것은 옵저버가 특정 인터페이스(Observer 인터페이스)를 구현한다는 것 뿐이다.
2. Observer는 언제든지 새로 추가할 수 있다.
3. 새로운 옵저버를 추가하려고 해도 Subject를 변경할 필요는 없다.
    - 옵저버가 되어야하는 새로운 concrete class가 있다고 할 때, 그 클래스가 Observer 인터페이스를 구현하고, 이를 Subject에서 옵저버로 등록하기만 하면된다.
4. Subject와 Observer는 서로 독립적으로 재사용할 수 있다.
5. Subject와 Observer는 서로 영향을 미치지 않는다.

## 요약

1. 옵저버 패턴에서는 객체들 사이에 일대다 관계를 정의한다.
2. 옵저버 패턴을 이용하여 Subject 객체에서 데이터를 보내거나(푸시) 옵저버가 데이터를 가져오는(풀 방식)을 쓸 수 있다.
3. 옵저버들에게 연락을 돌리는 순서에 의존하면 안된다.

## 참고자료

- Head First Design Pattern
